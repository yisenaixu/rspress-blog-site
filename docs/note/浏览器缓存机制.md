![img](https://s2.loli.net/2024/03/20/ISuxYoOcPW7LmrH.png)

## 缓存过程

1. 浏览器第一次发送HTTP请求
2. 浏览器缓存没有检测到该请求的缓存结果和标识
3. 浏览器向服务器发送HTTP请求
4. 服务器响应返回结果中包括缓存规则
5. 允许缓存则浏览器将结果和标识存入浏览器缓存中

### 强制缓存

浏览器向浏览器缓存查找请求结果，根据该结果缓存规则决定是否使用缓存结果的过程

##### 情况

1. 浏览器缓存中不存在该缓存，直接向服务器发起请求
2. 存在但失效，采用**协商缓存**
3. 存在且未失效，直接返回该结果

##### 规则

###### Expires： 缓存到期时间 HTTP1.0

###### Cache-Control:  控制网页缓存 HTTP1.1

1. public 所有内容都缓存
2. private 只有客户端可以缓存，默认值
3. no-cache 客户端缓存内容，是否使用由协商缓存验证
4. no-store 所有内容不缓存
5. max-age=num 缓存内容失效时间

### 协商缓存

强制缓存失败后，浏览器携带缓存标识向服务器请求，服务器根据标识决定是否使用缓存

##### 情况

生效，返回304，浏览器使用缓存结果

失效，返回200和新的结果，浏览器将结果存入缓存

##### 规则

###### Last-Modified/If-Modified-Since

last-modifiled 服务器响应返回文件在服务器最后修改的时间

If-Modified-Since 浏览器通过此字段返回上次请求返回的Last-Modified值，比较两次修改时间判断是否使用缓存

###### Etag/If-None-Match

Etag 服务器响应返回该资源文件的唯一标识

If-None-Match 客户端发送请求通过此字段携带上次请求的Etag值，进行对比，判断资源是否更新，是否使用缓存



